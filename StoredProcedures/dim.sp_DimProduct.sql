CREATE   PROCEDURE [dim].[sp_DimProduct] AS BEGIN SET NOCOUNT ON; TRUNCATE TABLE [dim].[DimProduct]; INSERT INTO [dim].[DimProduct] ([ProductID], [ProductName], [ProductCode], [Brand], [UnitPrice], [UnitCost], [Weight], [Color], [Size], [LaunchDate], [DiscontinuedDate], [IsActive], [CategoryName], [CategoryDescription], [ParentCategoryID]) SELECT [ProductID], [ProductName], [ProductCode], [Brand], [UnitPrice], [UnitCost], [Weight], [Color], [Size], [LaunchDate], [DiscontinuedDate], [IsActive], [CategoryName], [CategoryDescription], [ParentCategoryID] FROM [dim].[v_DimProduct]; UPDATE KeyVault.SurrogateKeys SET MaxKey = ISNULL((SELECT MAX(SK_DimProduct) FROM [dim].[DimProduct]), 0) WHERE TableName = 'dim.DimProduct'; END
GO
